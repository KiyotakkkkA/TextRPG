# Руководство по созданию квестов

Это руководство описывает процесс создания квестов для игры.

## Содержание

1. [Общая структура квестов](#общая-структура-квестов)
2. [Стадии и цели квестов](#стадии-и-цели-квестов)
   - [Типы целей](#типы-целей)
3. [Награды и требования](#награды-и-требования)
4. [Организация файлов](#организация-файлов)
5. [Полные примеры](#полные-примеры)

## Общая структура квестов

Каждый квест определяется в JSON-файле следующей структурой:

```json
{
  "id": "quest_id",
  "name": "Название квеста",
  "description": "Описание квеста",
  "giver_id": "npc_id_выдающего_квест",
  "taker_id": "npc_id_принимающего_квест",
  "completion_text": "Текст при завершении квеста",
  "requirements": {
    // требования для начала квеста
  },
  "rewards": {
    // награды за выполнение квеста
  },
  "stages": [
    // стадии квеста
  ]
}
```

Базовые поля для любого квеста:

- **id** - уникальный идентификатор квеста, используется в коде
- **name** - отображаемое название квеста
- **description** - описание квеста, которое видит игрок
- **giver_id** - ID NPC, который выдает квест
- **taker_id** - ID NPC, который принимает выполненный квест (может совпадать с giver_id)
- **completion_text** - текст, который отображается при завершении квеста
- **requirements** - требования для начала квеста
- **rewards** - награды за выполнение квеста
- **stages** - список стадий квеста

## Стадии и цели квестов

Квест разделен на **стадии** (stages), каждая из которых содержит одну или несколько **целей** (objectives).

Стадия имеет следующую структуру:

```json
{
  "name": "Название стадии",
  "description": "Описание стадии",
  "objectives": [
    // цели стадии
  ]
}
```

### Типы целей

Каждая цель имеет тип и другие атрибуты в зависимости от типа:

#### 1. Сбор предметов (collect/gather)

Цель по сбору определенного количества предметов:

```json
{
  "type": "collect",
  "item_id": "id_предмета",
  "count": 5,
  "description": "Собрать 5 единиц предмета"
}
```

#### 2. Разговор с NPC (talk)

Цель, требующая разговора с определенным NPC:

```json
{
  "type": "talk",
  "npc_id": "id_npc",
  "description": "Поговорить с NPC"
}
```

#### 3. Посещение локации (goto/location)

Цель, требующая посещения определенной локации:

```json
{
  "type": "goto",
  "location_id": "id_локации",
  "description": "Посетить локацию"
}
```

#### 4. Убийство монстров (kill)

Цель по уничтожению определенного количества монстров:

```json
{
  "type": "kill",
  "monster_id": "id_монстра",
  "count": 3,
  "description": "Победить 3 монстров"
}
```

#### 5. Пользовательская цель (custom)

Цель, которая требует специальной логики для завершения:

```json
{
  "type": "custom",
  "id": "unique_id_цели",
  "completed": false,
  "description": "Выполнить специальное действие"
}
```

## Награды и требования

### Награды

Награды за выполнение квеста могут включать:

```json
"rewards": {
  "experience": 100,      // Опыт игрока
  "money": 50,            // Деньги (монеты)
  "items": {              // Предметы: {item_id: количество}
    "healing_potion": 1,
    "iron_sword": 1
  },
  "skills": {             // Опыт навыков: {skill_id: количество_опыта}
    "herbalism": 30,
    "elementalism": 20
  }
}
```

### Требования

Требования для начала квеста могут включать:

```json
"requirements": {
  "level": 5,             // Минимальный уровень персонажа
  "skills": {             // Требуемые навыки: {skill_id: уровень_навыка}
    "herbalism": 2,
    "elementalism": 1
  },
  "items": {              // Требуемые предметы: {item_id: количество}
    "magic_crystal": 1
  },
  "quests": [             // ID квестов, которые должны быть выполнены
    "village_intro",
    "forest_exploration"
  ]
}
```

## Организация файлов

Квесты могут быть организованы в JSON-файлах несколькими способами:

1. **По локациям/регионам** - можно создать отдельные файлы для квестов в каждом регионе:

   - `village_quests.json` - квесты в деревне
   - `forest_quests.json` - квесты в лесу
   - `city_quests.json` - квесты в городе

2. **По уровням/главам** - можно организовать квесты по уровням или главам игры:

   - `chapter1_quests.json` - квесты первой главы
   - `chapter2_quests.json` - квесты второй главы

3. **По типам** - можно разделить квесты по типам:

   - `main_quests.json` - основные сюжетные квесты
   - `side_quests.json` - побочные задания
   - `daily_quests.json` - ежедневные задания

Файлы квестов должны находиться в директории `resources/quests/`.

## Полные примеры

### Квест на сбор предметов

```json
{
  "id": "collect_herbs",
  "name": "Целебные травы",
  "description": "Деревенскому лекарю срочно требуются зверобой и волчья погибель для приготовления лекарств. Соберите 3 зверобоя и 2 волчьей погибели в лесу.",
  "giver_id": "village_elder",
  "taker_id": "village_elder",
  "completion_text": "Благодарю тебя! Эти травы помогут нашему лекарю спасти многие жизни. Вот твоя награда за проделанную работу.",
  "requirements": {
    "level": 1,
    "skills": {
      "herbalism": 1
    }
  },
  "rewards": {
    "experience": 150,
    "money": 100,
    "items": {
      "healing_potion": 1
    },
    "skills": {
      "herbalism": 30
    }
  },
  "stages": [
    {
      "name": "Сбор зверобоя",
      "description": "Соберите 3 зверобоя в лесу",
      "objectives": [
        {
          "type": "gather",
          "item_id": "beast_plant",
          "count": 3
        }
      ]
    },
    {
      "name": "Сбор волчьей погибели",
      "description": "Соберите 2 волчьей погибели в лесу",
      "objectives": [
        {
          "type": "gather",
          "item_id": "wolfbane",
          "count": 2
        }
      ]
    },
    {
      "name": "Вернуться к старейшине",
      "description": "Вернитесь к старейшине деревни с собранными травами",
      "objectives": [
        {
          "type": "talk",
          "npc_id": "village_elder"
        }
      ]
    }
  ]
}
```

### Квест с посещением локаций

```json
{
  "id": "missing_child",
  "name": "Пропавший ребенок",
  "description": "Сын одного из жителей пропал во время прогулки в лесу. Необходимо найти его и вернуть в деревню.",
  "giver_id": "village_elder",
  "taker_id": "village_elder",
  "completion_text": "Спасибо тебе! Ты вернул радость в семью и спас молодую жизнь. Вся деревня тебе благодарна. Вот твоя награда, ты заслужил её.",
  "requirements": {
    "level": 3
  },
  "rewards": {
    "experience": 300,
    "money": 250,
    "skills": {
      "elementalism": 40
    }
  },
  "stages": [
    {
      "name": "Расспросить жителей",
      "description": "Поговорите с жителями деревни, чтобы узнать подробности",
      "objectives": [
        {
          "type": "talk",
          "npc_id": "village_elder"
        }
      ]
    },
    {
      "name": "Поискать в лесу",
      "description": "Исследуйте лес в поисках следов ребенка",
      "objectives": [
        {
          "type": "goto",
          "location_id": "forest"
        }
      ]
    },
    {
      "name": "Найти ребенка",
      "description": "Вы находите ребенка в пещере, куда он забрел, испугавшись грозы",
      "objectives": [
        {
          "type": "goto",
          "location_id": "cave"
        }
      ]
    },
    {
      "name": "Вернуться в деревню",
      "description": "Вернитесь в деревню вместе с ребенком",
      "objectives": [
        {
          "type": "goto",
          "location_id": "village"
        }
      ]
    },
    {
      "name": "Сообщить старейшине",
      "description": "Сообщите старейшине о том, что ребенок найден",
      "objectives": [
        {
          "type": "talk",
          "npc_id": "village_elder"
        }
      ]
    }
  ]
}
```

### Квест с сражениями

```json
{
  "id": "monster_hunt",
  "name": "Охота на чудовище",
  "description": "В пещерах на севере появилось опасное чудовище. Убейте его, чтобы обезопасить торговый путь.",
  "giver_id": "village_elder",
  "taker_id": "village_elder",
  "completion_text": "Отлично! Ты справился с этим опасным существом. Теперь торговцы могут безопасно проходить по своему маршруту. Вот твоя награда.",
  "requirements": {
    "level": 5
  },
  "rewards": {
    "experience": 500,
    "money": 300,
    "items": {
      "magic_amulet": 1
    }
  },
  "stages": [
    {
      "name": "Найти вход в пещеры",
      "description": "Найдите северный вход в пещеры",
      "objectives": [
        {
          "type": "goto",
          "location_id": "cave_entrance"
        }
      ]
    },
    {
      "name": "Исследовать пещеры",
      "description": "Исследуйте пещеры в поисках чудовища",
      "objectives": [
        {
          "type": "goto",
          "location_id": "deep_cave"
        }
      ]
    },
    {
      "name": "Победить чудовище",
      "description": "Сразитесь с чудовищем и победите его",
      "objectives": [
        {
          "type": "kill",
          "monster_id": "cave_monster",
          "count": 1
        }
      ]
    },
    {
      "name": "Сообщить о выполнении",
      "description": "Вернитесь к старейшине и расскажите о победе",
      "objectives": [
        {
          "type": "talk",
          "npc_id": "village_elder"
        }
      ]
    }
  ]
}
```

### Структура файла с несколькими квестами

```json
{
  "quests": [
    {
      "id": "quest1"
      // свойства первого квеста
    },
    {
      "id": "quest2"
      // свойства второго квеста
    }
    // другие квесты...
  ]
}
```
